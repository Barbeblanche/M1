<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">
<head>
<!-- 2019-11-20 Wed 17:22 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>COO - TP sur l'héritage</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Guillaume Huard" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">COO - TP sur l'héritage</h1>
<p>
Dans ce TP, nous allons manipuler des relations d'héritage entre classes et voir comment l'héritage
nous permet de gagner une abstraction de nos types de données (polymorphisme) et d'étendre nos
classes de manière à gagner de nouveaux comportements pour nos objets tout en factorisant le
comportement commun.
</p>

<div id="outline-container-org0da8520" class="outline-2">
<h2 id="org0da8520"><span class="section-number-2">1</span> Échauffement</h2>
<div class="outline-text-2" id="text-1">
<ol class="org-ol">
<li><p>
Qu'affiche le code suivant ?
</p>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #a020f0;">public</span> <span style="color: #a020f0;">abstract</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">A</span> {
    <span style="color: #a020f0;">abstract</span> <span style="color: #228b22;">String</span> <span style="color: #0000ff;">un</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">n</span>);
    <span style="color: #a020f0;">abstract</span> <span style="color: #228b22;">String</span> <span style="color: #0000ff;">un</span>(<span style="color: #228b22;">char</span> <span style="color: #a0522d;">x</span>);
    <span style="color: #a020f0;">abstract</span> <span style="color: #228b22;">String</span> <span style="color: #0000ff;">un</span>(<span style="color: #228b22;">String</span> <span style="color: #a0522d;">s</span>);

    <span style="color: #228b22;">String</span> <span style="color: #0000ff;">deux</span>() {
        <span style="color: #a020f0;">return</span> <span style="color: #8b2252;">"A deux"</span>;
    }
}
</pre>
</div>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #a020f0;">public</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">B</span> <span style="color: #a020f0;">extends</span> <span style="color: #228b22;">A</span> {
    <span style="color: #228b22;">String</span> <span style="color: #0000ff;">un</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">n</span>) {
        <span style="color: #a020f0;">return</span> un(Integer.toString(n));
    }
    <span style="color: #228b22;">String</span> <span style="color: #0000ff;">un</span>(<span style="color: #228b22;">char</span> <span style="color: #a0522d;">x</span>) {
        <span style="color: #a020f0;">return</span> <span style="color: #8b2252;">"B un "</span> + x;
    }
    <span style="color: #228b22;">String</span> <span style="color: #0000ff;">un</span>(<span style="color: #228b22;">String</span> <span style="color: #a0522d;">s</span>) {
        <span style="color: #a020f0;">return</span> <span style="color: #8b2252;">"B un "</span> + s;
    }
}
</pre>
</div>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #a020f0;">public</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">C</span> <span style="color: #a020f0;">extends</span> <span style="color: #228b22;">B</span> {
    <span style="color: #228b22;">String</span> <span style="color: #0000ff;">un</span>(<span style="color: #228b22;">String</span> <span style="color: #a0522d;">s</span>) {
        <span style="color: #a020f0;">return</span> <span style="color: #8b2252;">"C un "</span> + s;
    }
}
</pre>
</div>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #a020f0;">public</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">ABC</span> {
    <span style="color: #a020f0;">public</span> <span style="color: #a020f0;">static</span> <span style="color: #228b22;">void</span> <span style="color: #0000ff;">main</span>(<span style="color: #228b22;">String</span> [] <span style="color: #a0522d;">args</span>) {
        <span style="color: #228b22;">A</span> <span style="color: #a0522d;">objet</span> = <span style="color: #a020f0;">new</span> <span style="color: #228b22;">C</span>();
        System.out.println(objet.un(42));
        System.out.println(objet.un(<span style="color: #8b2252;">'X'</span>));
        System.out.println(objet.un(<span style="color: #8b2252;">"42"</span>));
        System.out.println(objet.deux());
    }
}
</pre>
</div></li>
<li><p>
En interdisant à une classe d'afficher le nom d'une autre classe, écrivez les classe <code>D</code>, <code>E</code>, <code>F</code> afin que le code suivant :
</p>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #a020f0;">public</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">DEF</span> {
    <span style="color: #a020f0;">public</span> <span style="color: #a020f0;">static</span> <span style="color: #228b22;">void</span> <span style="color: #0000ff;">main</span>(<span style="color: #228b22;">String</span> [] <span style="color: #a0522d;">args</span>) {
        <span style="color: #228b22;">D</span> <span style="color: #a0522d;">objet</span> = <span style="color: #a020f0;">new</span> <span style="color: #228b22;">F</span>();
        System.out.println(objet.un(42));
        System.out.println(objet.un(<span style="color: #8b2252;">'X'</span>));
        System.out.println(objet.un(<span style="color: #8b2252;">"42"</span>));
        System.out.println(objet.deux());
    }
}
</pre>
</div>
<p>
affiche
</p>
<pre class="example">
D un 42
E un X
F un 42
F deux
</pre></li>
</ol>
</div>
</div>

<div id="outline-container-org51ea566" class="outline-2">
<h2 id="org51ea566"><span class="section-number-2">2</span> Documents et alignement</h2>
<div class="outline-text-2" id="text-2">
<p>
Pour commencer, reprenez l'ensemble des classes obtenues au TP précédent pour gérer des documents
textuels. L'objectif ici va être de changer l'alignement de certains éléments de nos documents.
</p>
</div>

<div id="outline-container-org445f640" class="outline-3">
<h3 id="org445f640"><span class="section-number-3">2.1</span> Paragraphes</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Dans cette partie, nous souhaitons que les paragraphes puissent être alignés à gauche ou à
droite. Pour cela, nous souhaitons généraliser la classe <code>Paragraphe</code>, qui devra contenir les
parties communes à tous les paragraphes, qu'ils soient alignés à gauche ou à droite. Ensuite, la
gestion de l'alignement se fera dans deux classes <code>ParagrapheGauche</code> et <code>ParagrapheDroite</code>
spécialisant le <code>Paragraphe</code>.  Tout ceci est résumé dans le diagramme suivant :
</p>

<div class="figure">
<p><img src="Paragraphe.png" alt="Paragraphe.png" />
</p>
</div>

<p>
Implémentez cette solution et vérifiez son bon fonctionnement.
</p>

<p>
<b>Questions</b>
</p>
<ol class="org-ol">
<li><p>
Quelle(s) partie(s) de votre programme faut-il modifier pour changer l'alignement (c'est-à-dire
pour utiliser la bonne variante de <code>Paragraphe</code>) ?
</p>
<p>
<br />
<b>Correction</b> :
Toutes les parties qui instancient un paragraphe, c'est à dire un seul endroit : dans la lecture du
document en entrée où les paragraphes sont remplis mot par mot et ajoutés au chapitre en cours.
</p></li>
<li><p>
A quoi sert maintenant la classe <code>Paragraphe</code> ?
</p>
<p>
<br />
<b>Correction</b> :
Elle sert de classe parente pour toutes les spécialisations de paragraphe. Elle est utilisée pour
référencer tous les paragraphes partout dans le code et être ainsi indépendant du choix de la
classe concrète utilisée pour chaque paragraphe lors de sa création.
</p></li>
</ol>
</div>
</div>

<div id="outline-container-org8fdfd0a" class="outline-3">
<h3 id="org8fdfd0a"><span class="section-number-3">2.2</span> Texte</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Nous souhaitons faire de même avec les textes centrés :
</p>
<ul class="org-ul">
<li>la classe <code>Texte</code> va maintenant contenir la partie commune à tous les textes ;</li>
<li>des spécialisations de <code>Texte</code> permettront de jouer sur l'alignement :
<ul class="org-ul">
<li><code>TexteCentre</code> pour centrer le texte, comme dans le précédent TP ;</li>
<li><code>TexteGauche</code> pour l'aligner à gauche ;</li>
<li><code>TexteDroite</code> pour l'aligner à droite.</li>
</ul></li>
</ul>
<p>
Cela est résumé sur le diagramme suivant :
</p>

<div class="figure">
<p><img src="Texte.png" alt="Texte.png" />
</p>
</div>

<p>
Implémentez cette solution afin de jouer sur l'alignement de l'entête du document ainsi que du titre
de chaque chapitre. Vérifiez le bon fonctionnement de votre implémentation.
</p>

<p>
<b>Questions</b>
</p>
<ol class="org-ol">
<li><p>
Quelle(s) partie(s) de votre programme faut-il modifier pour changer l'alignement (c'est-à-dire
pour utiliser la bonne variante de <code>Texte</code> dans l'entête et les titres de chapitres) ?
</p>
<p>
<br />
<b>Correction</b> :
La classe <code>Texte</code> intervient dans l'entête du document, pour le titre, l'auteur et la date, ainsi
que dans le titre des chapitres. Il faut donc changer tous les endroit où ces éléments textuels
sont créés, cela représente plusieurs lignes dans deux classes différentes.
</p></li>
<li><p>
Est-il possible d'écrire un seul programme qui affiche deux fois une texte donné,
d'abord avec les titres centrés et ensuite avec les titres alignés à droite ?
</p>
<ul class="org-ul">
<li>si oui, expliquez comment ;</li>
<li>si non, expliquez pourquoi.</li>
</ul>
<p>
<br />
<b>Correction</b> :
Ici, on attend plutôt la réponse : c'est impossible. Mais les deux réponses sont possibles du
moment que c'est argumenté. Les objets dérivant de <code>Texte</code> étant instanciés dans les classes
<code>Chapitre</code> et <code>Entete</code>, pour changer leur alignement il faut changer le code source de ces classes. On
ne peut donc pas dans une seule exécution avoir les deux comportements à moins de :
</p>
<ul class="org-ul">
<li>recourir à de la duplication (classes <code>Entete</code>, <code>Chapitre</code> et <code>Document</code>), très mauvaise solution.</li>
<li>recourir à un pattern de style fabrique, pour construire deux fois le texte avec deux
alignements différents, mais nous ne l'avons pas encore vu.</li>
<li>recourir à un pattern de style stratégie, pour changer l'algorithme d'alignement à la volée,
mais nous ne l'avons pas encore vu.</li>
</ul></li>
<li><p>
Si quelqu'un souhaite écrire un nouveau type de texte qui s'affiche entouré d'étoiles (mise en
valeur) et centré. Peut-il le faire et utiliser sa solution sans modifier votre code source
(excepté le programme principal) ?
</p>
<ul class="org-ul">
<li>si oui, expliquez comment ;</li>
<li>si non, expliquez pourquoi.</li>
</ul>
<p>
<br />
<b>Correction</b> :
En fait c'est un peu la même question que précédemment habillée différemment, les
mêmes arguments s'appliquent : pour changer l'entête et les titres on doit intervenir sur le code des classes
<code>Chapitre</code> et <code>Entete</code>, on ne peut donc pas le faire sauf si on duplique sauvagement ou si on met en
place un pattern approprié. La réponse est plutôt non mais les deux s'argumentent.
</p></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orga205aac" class="outline-2">
<h2 id="orga205aac"><span class="section-number-2">3</span> Formes géométriques</h2>
<div class="outline-text-2" id="text-3">
<p>
Dans cet exercice vous allez devoir dessiner dans une fenêtre à l'aide d'un petit module de dessin
qui implémente l'équivalent d'une tortue LOGO.
</p>
</div>

<div id="outline-container-org7956271" class="outline-3">
<h3 id="org7956271"><span class="section-number-3">3.1</span> La machine</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Récupérez le fichier <a href="https://gricad-gitlab.univ-grenoble-alpes.fr/projet/machinetrace/raw/master/MachineTrace.java">MachineTrace.java</a>. Ce fichier contient l'implémentation d'une mini bibliothèque
graphique qui vous fournit des primitives simples permettant de dessiner dans une fenêtre. Vous
pouvez trouver une documentation détaillée du contenu de cette classe <a href="https://projet.gricad-pages.univ-grenoble-alpes.fr/machinetrace">ici</a>.  La création d'une
machine à tracer provoque l'ouverture d'une fenêtre dont les dimensions sont données au constructeur
de la machine.  Dans la machine à tracer, les tracés sont effectués par une plume, et les primitives
permettent de manipuler cette plume. L'état de la plume est défini par :
</p>
<ul class="org-ul">
<li>sa position d'écriture qui peut être haute ou basse ;</li>
<li>ses coordonnées dans la fenêtre graphique : le centre O du repère est au centre de la fenêtre,
l'axe des x est orienté à droite, celui des y en haut ;</li>
<li>son orientation (ou cap) par rapport à l'axe Ox, exprimé par un angle en degrés dans le sens
trigonométrique.</li>
</ul>

<p>
Les principales primitives de manipulations sont les méthodes suivantes, implémentées par <code>MachineTrace</code> :
</p>
<ul class="org-ul">
<li><code>lever()</code> et <code>baisser()</code> qui modifient l'état de la position d'écriture ; ces fonctions n'ont pas de paramètre ;</li>
<li><code>avancer(double L)</code> qui déplace la plume de la distance L dans la direction de son cap
(donner un L négatif pour reculer) ;</li>
<li><code>placer(double x, double y)</code> qui place la plume au point de coordonnées (x, y) sans changer son cap ;</li>
<li><code>tournerGauche(double a)</code> et <code>tournerDroite(double a)</code> qui ajoutent ou soustraient l'angle a au cap courant ;</li>
<li><code>orienter(double a)</code> qui oriente la plume dans la direction a ;</li>
<li><code>attendre(int ms)</code> qui permet d'attendre ms millisecondes.</li>
</ul>

<p>
La plume trace un trait lors de ses déplacements en position basse, c'est-à-dire que les méthodes
<code>avancer</code> et <code>placer</code> tracent un trait lorsque la plume est basse.  Le fichier <a href="https://gricad-gitlab.univ-grenoble-alpes.fr/projet/machinetrace/raw/master/UnSegment.java">UnSegment.java</a>
contient un programme utilisant cette bibliothèque pour ouvrir une fenêtre à l'écran (de dimension
400x400 pixels) et y tracer un segment.  Un autre programme, contenu dans <a href="https://gricad-gitlab.univ-grenoble-alpes.fr/projet/machinetrace/raw/master/SegmentsAlignes.java">SegmentsAlignes.java</a> trace
20 segments en diagonale de couleurs différentes avant de tout effacer et de recommencer dans
l'autre sens.  En outre, chaque segment est tracé progressivement par pas de 10 avec des attentes
après chaque commande, ce qui donne l'impression de déplacement de la plume.
</p>
</div>
</div>

<div id="outline-container-org6489d1b" class="outline-3">
<h3 id="org6489d1b"><span class="section-number-3">3.2</span> Formes pulsantes</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Le but de l'exercice est d'écrire les classes permettant de compléter l'application écrite dans le
fichier <a href="./tp-formes/src/FormesPulsantes.java">FormesPulsantes.java</a>. Pour cela vous devrez écrire la classe <code>Forme</code> ainsi que les classes
<code>Carre</code>, <code>Triangle</code>, <code>Cercle</code> et <code>Losange</code> qui en héritent. Pour pouvoir fonctionner avec le
programme donné, les classes <code>Carre</code>, <code>Triangle</code>, <code>Cercle</code> et <code>Losange</code> doivent avoir un
constructeur prenant en argument une <code>MachineTrace</code> (celle dans laquelle il faudra dessiner). En
outre, la classe <code>Forme</code> devra contenir les méthodes :
</p>
<ul class="org-ul">
<li><code>void fixerPosition(int x, int y);</code><br />
Détermine la position à laquelle la forme devra être dessinée (centre) ;</li>
<li><code>void fixerTaille(int t);</code><br />
Détermine la taille (coté) d'un carré contenant la forme ;</li>
<li><code>void dessiner();</code><br />
Dessine la forme en tenant compte des position et
taille donnés précédemment à l'objet et en supposant que la plume se trouve dans un
état quelconque.</li>
</ul>
<p>
qui devront peut-être être spécialisées dans les classes filles. Étant donné la manière
dont le programme donné est écrit, il ne faudra faire des appels aux méthodes de la
machine trace que dans la méthode <code>dessiner</code>. Vous pouvez travailler de manière
incrémentale en commençant par <code>Forme</code> et <code>Carre</code> en fixant la valeur de la
variable <code>nbFormes</code> à 1. Par la suite vous pourrez ajouter un nouveau type de forme
à la fois en augmentant cette variable de 1 à chaque fois.
</p>
</div>
</div>

<div id="outline-container-orge026a9e" class="outline-3">
<h3 id="orge026a9e"><span class="section-number-3">3.3</span> Pulsations optionnelles</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Nous souhaitons maintenant déplacer le code qui gère la pulsation dans une classe <code>FormePulsante</code> et
faire en sorte qu'une partie seulement des objets soient pulsants. Un <code>FormePulsante</code> :
</p>
<ul class="org-ul">
<li>contiendra les étapes de pulsation ainsi que l'amplitude ;</li>
<li>pourra avancer d'une étape à la suivante et fournir en retour la valeur à ajouter à la taille d'un objet.</li>
</ul>
<p>
Une fois cela mis en place, nous souhaitons que certains objets soient statiques tandis que d'autres
soient pulsants. Pour cela, nous souhaitons disposer de classes <code>CarreStatique</code>, <code>CarrePulsant</code>, <code>TriangleStatique</code>,
<code>TrianglePulsant</code>, et ainsi de suite.
</p>

<p>
Le programme principal va maintenant se contenter de créer les objets en choisissant au hasard dans
les variantes disponibles, puis, dans sa boucle infinie,
à chaque pas de temps et pour chaque objet :
</p>
<ul class="org-ul">
<li>de faire avancer l'objet d'une étape et de modifier sa taille en conséquence</li>
<li>d'afficher l'objet</li>
</ul>

<p>
<b>Questions</b>
</p>
<ol class="org-ol">
<li><p>
Quelle(s) classe(s) manque-t-il dans la description ci-dessus pour que TOUTES les variantes
d'objets puissent avancer d'une étape à une autre sous la direction du programme principal ?
(indice : avancer d'une étape à une autre ne veut pas forcément dire changer quelque chose).
</p>
<p>
<br />
<b>Correction</b> :
Il faut que tous les objets disposent d'une méthode leur permettant d'avancer dans
les étapes d'animation. Par exemple nous pourrons avoir une classe (abstraite) <code>FormeAnimee</code>
disposant de la méthode <code>avancerEtape</code>. Cette classe peut alors se décliner en <code>FormeStatique</code> (qui
ne bouge pas) et <code>FormePulsante</code> (qui pulse). Ainsi il est possible d'appeler la méthode
<code>avancerEtape</code> sur tous les objets, qu'ils soient immobiles ou qu'ils pulsent.
</p></li>
<li><p>
Quel type de relation entre classes reconnaissez vous dans ce nouveau problème ?
Quelle difficulté cela pose-t-il pour implémenter ces variantes d'objets en java ?
</p>
<p>
<br />
<b>Correction</b> :
Il s'agit d'un cas où nous aurions besoin d'héritage multiple. En effet, le
<code>CarrePulsant</code> par exemple devrait hériter du <code>Carre</code> et de la <code>FormePulsante</code>. Cela pose une
difficulté en java car le langage ne permet pas l'héritage multiple.
</p></li>
<li><p>
Trouvez une solution pour contourner le problème précédent et implémentez la.
</p>
<p>
<br />
<b>Correction</b> : La solution adoptée dans le corrigé est de remplacer l'héritage par une
aggrégation. La <code>FormeAnimee</code> dépend de la <code>Forme</code> (par aggrégation) et propose la même
spécification en déléguant tous les traitements à la forme qu'elle contient. Elle contient une
nouvelle méthode <code>avancerEtape</code> permettant au programme principal de faire avancer
l'animation. Le programme principal ne gère plus que des formes animées et active la pulsation ou
non dans une forme selon le résultat d'un tirage aléatoire lors de sa création.
</p></li>
</ol>
</div>
</div>

<div id="outline-container-orgc453283" class="outline-3">
<h3 id="orgc453283"><span class="section-number-3">3.4</span> Rotations et clignotement</h3>
<div class="outline-text-3" id="text-3-4">
<p>
De manière analogue au cas des pulsations optionnelles, nous souhaitons maintenant ajouter à nos
formes animées des variantes avec rotation et des variantes avec clignotement. Bien entendu toutes
les variantes seront possibles, il y aura : des carrés non pulsants non tournants non clignotants,
des carrés non pulsants non tournants clignotants, des carrés non pulsants tournants clignotants,
des carrés pulsants non tournants clignotants, et ainsi de suite pour toutes les variantes et toutes
les formes.
</p>

<p>
<b>Questions</b>
</p>
<ol class="org-ol">
<li><p>
Expliquez pourquoi une solution comme celle proposée pour les pulstations optionnelles n'est pas
adaptée ici.
</p>
<p>
<br />
<b>Correction</b> :
Avec 4 formes et 3 formes d'animations cela nous done 32 classes différentes pour implémenter
toutes les variantes. Ce n'est pas raisonnable.
</p></li>
<li><p>
Proposez une autre solution, fondée aussi sur une conception orientée objet (les caractères
optionnels seront chacun implémentés dans une classe distincte) mais évitant de reproduire le
défaut la première solution et extensible (on pourra ajouter un nouveau caractère optionnel en ne
modifiant que le programme principal).
</p>
<p>
<br />
<b>Correction</b> :
Il nous faudrait une solution de type décorateur :
</p>
<ul class="org-ul">
<li>Les <code>Forme</code> sont agrégées dans une <code>FormeStatique</code> ;</li>
<li>La <code>FormeStatique</code> et décorée au besoin autant de fois que nécessaire, chaque type d'animation
étant réalisé par un décorateur différent.</li>
</ul>
<p>
Les décorateurs n'ayant pas encore été vus, on privilégiera l'argumentaire, la compréhension du
problème et l'inventivité de la solution proposée. Le corrigé présente une mauvaise solution dans
laquelle la <code>FormeAnimee</code> gère toutes les variantes d'animation. C'est une mauvaise solution car
non extensible : si nous voulons ajouter une nouvelle variante, il faut changer le code déjà
volumineux de la <code>FormeAnimee</code>.
</p></li>
</ol>
</div>
</div>
</div>
</div>
</body>
</html>
